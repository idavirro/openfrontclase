<!doctype html>
<html lang="en" class="h-full" translate="no">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <title>OpenFront - School Edition</title>
    <link rel="manifest" href="../../resources/manifest.json" />
    <link
      rel="icon"
      type="image/x-icon"
      href="../../resources/images/Favicon.svg"
    />

    <!-- Critical CSS to prevent FOUC -->
    <style>
      .preload * {
        -webkit-transition: none !important;
        -moz-transition: none !important;
        -ms-transition: none !important;
        -o-transition: none !important;
        transition: none !important;
      }

      html {
        visibility: visible;
        opacity: 1;
      }

      html.preload {
        visibility: hidden;
        opacity: 0;
      }

      .bg-image {
        content: "";
        background-image: url("/images/EuropeBackground.webp");
        background-position: center;
        background-attachment: fixed;
        background-size: cover;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
      }

      .bg-image::before {
        content: "";
        position: absolute;
        width: 100%;
        height: 100vh;
        backdrop-filter: blur(5px);
      }

      .dark .bg-image {
        filter: brightness(0.4) saturate(0.3) contrast(1.2);
      }

      .simple-form {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 12px;
        padding: 2rem;
        max-width: 500px;
        margin: 2rem auto;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
      }

      .dark .simple-form {
        background: rgba(55, 65, 81, 0.9);
        color: white;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 600;
        color: #374151;
      }

      .dark .form-label {
        color: #f9fafb;
      }

      .form-input {
        width: 100%;
        padding: 12px;
        border: 2px solid #d1d5db;
        border-radius: 8px;
        font-size: 16px;
        transition: border-color 0.2s;
      }

      .form-input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      .dark .form-input {
        background: rgba(75, 85, 99, 0.5);
        border-color: #6b7280;
        color: white;
      }

      .dark .form-input:focus {
        border-color: #60a5fa;
      }

      .btn {
        width: 100%;
        padding: 12px;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
        margin-bottom: 0.5rem;
      }

      .btn-primary {
        background: #3b82f6;
        color: white;
      }

      .btn-primary:hover {
        background: #2563eb;
        transform: translateY(-1px);
      }

      .btn-secondary {
        background: #6b7280;
        color: white;
      }

      .btn-secondary:hover {
        background: #4b5563;
        transform: translateY(-1px);
      }

      .title {
        text-align: center;
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 2rem;
        color: #1f2937;
      }

      .dark .title {
        color: #f9fafb;
      }

      .status {
        text-align: center;
        padding: 1rem;
        margin: 1rem 0;
        border-radius: 8px;
        font-weight: 500;
      }

      .status-info {
        background: #dbeafe;
        color: #1e40af;
        border: 1px solid #93c5fd;
      }

      .dark .status-info {
        background: rgba(30, 64, 175, 0.2);
        color: #93c5fd;
        border-color: #3b82f6;
      }

      .status-success {
        background: #dcfce7;
        color: #166534;
        border: 1px solid #86efac;
      }

      .dark .status-success {
        background: rgba(22, 101, 52, 0.2);
        color: #86efac;
        border-color: #16a34a;
      }

      .players-list {
        background: rgba(0, 0, 0, 0.05);
        border-radius: 8px;
        padding: 1rem;
        margin: 1rem 0;
      }

      .dark .players-list {
        background: rgba(255, 255, 255, 0.05);
      }

      .player-item {
        display: flex;
        align-items: center;
        padding: 0.5rem;
        margin: 0.25rem 0;
        background: white;
        border-radius: 6px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .dark .player-item {
        background: rgba(75, 85, 99, 0.5);
      }

      .flag-display {
        width: 24px;
        height: 16px;
        margin-right: 0.5rem;
        border-radius: 2px;
      }
    </style>

    <!-- Immediate execution to prevent FOUC -->
    <script>
      document.documentElement.className = "preload";
    </script>
  </head>

  <body class="h-full select-none font-sans min-h-screen bg-opacity-0 bg-cover bg-center bg-fixed transition-opacity duration-300 ease-in-out flex flex-col">
    <div class="bg-image"></div>

    <!-- Main container -->
    <main class="flex justify-center flex-grow">
      <div class="simple-form">
        <h1 class="title">OpenFront - School Edition</h1>
        
        <!-- Game Status -->
        <div id="game-status" class="status status-info">
          Connecting to game server...
        </div>

        <!-- Player Setup Form -->
        <div id="setup-form">
          <div class="form-group">
            <label for="username" class="form-label">Your Name</label>
            <input 
              type="text" 
              id="username" 
              class="form-input" 
              placeholder="Enter your name"
              maxlength="20"
              required
            />
          </div>

          <div class="form-group">
            <label for="flag" class="form-label">Choose Your Flag</label>
            <select id="flag" class="form-input">
              <option value="us">ðŸ‡ºðŸ‡¸ United States</option>
              <option value="gb">ðŸ‡¬ðŸ‡§ United Kingdom</option>
              <option value="fr">ðŸ‡«ðŸ‡· France</option>
              <option value="de">ðŸ‡©ðŸ‡ª Germany</option>
              <option value="it">ðŸ‡®ðŸ‡¹ Italy</option>
              <option value="es">ðŸ‡ªðŸ‡¸ Spain</option>
              <option value="ca">ðŸ‡¨ðŸ‡¦ Canada</option>
              <option value="au">ðŸ‡¦ðŸ‡º Australia</option>
              <option value="jp">ðŸ‡¯ðŸ‡µ Japan</option>
              <option value="br">ðŸ‡§ðŸ‡· Brazil</option>
              <option value="mx">ðŸ‡²ðŸ‡½ Mexico</option>
              <option value="in">ðŸ‡®ðŸ‡³ India</option>
              <option value="cn">ðŸ‡¨ðŸ‡³ China</option>
              <option value="ru">ðŸ‡·ðŸ‡º Russia</option>
            </select>
          </div>

          <button id="join-game" class="btn btn-primary">
            Join Game
          </button>
          
          <button id="spectate-game" class="btn btn-secondary">
            Spectate Game
          </button>
        </div>

        <!-- Current Players -->
        <div id="players-section" style="display: none;">
          <h3>Current Players</h3>
          <div id="players-list" class="players-list">
            <!-- Players will be populated here -->
          </div>
        </div>

        <!-- Game Controls (shown when in game) -->
        <div id="game-controls" style="display: none;">
          <button id="leave-game" class="btn btn-secondary">
            Leave Game
          </button>
        </div>
      </div>
    </main>

    <!-- Game Canvas (hidden initially) -->
    <div id="app" style="display: none;"></div>
    
    <!-- Game UI Elements -->
    <div id="radialMenu" class="radial-menu" style="display: none;"></div>
    <div class="flex gap-2 fixed right-[10px] top-[10px] z-50 flex-col" style="display: none;">
      <player-info-overlay></player-info-overlay>
    </div>
    <div class="fixed bottom-[30px] sm:bottom-auto sm:top-[20px] z-50 mx-auto max-w-max inset-x-0 items-center" style="display: none;">
      <heads-up-message></heads-up-message>
    </div>
    <div class="bottom-0 w-full flex-col-reverse sm:flex-row z-50 md:w-[320px]" style="position: fixed; pointer-events: none; display: none;">
      <div class="w-full md:w-2/3 md:fixed sm:right-0 md:bottom-0 md:flex flex-col items-end" style="pointer-events: none">
        <chat-display></chat-display>
        <events-display></events-display>
      </div>
      <div style="pointer-events: auto">
        <control-panel></control-panel>
      </div>
    </div>

    <!-- Game modals and overlays (hidden initially) -->
    <emoji-table style="display: none;"></emoji-table>
    <build-menu style="display: none;"></build-menu>
    <win-modal style="display: none;"></win-modal>
    <game-starting-modal style="display: none;"></game-starting-modal>
    <game-top-bar style="display: none;"></game-top-bar>
    <unit-display style="display: none;"></unit-display>
    <div class="flex fixed top-[20px] right-[20px] z-[1000] items-start gap-2" style="display: none;">
      <replay-panel></replay-panel>
      <game-right-sidebar></game-right-sidebar>
    </div>
    <player-panel style="display: none;"></player-panel>
    <spawn-timer style="display: none;"></spawn-timer>
    <alert-frame style="display: none;"></alert-frame>
    <chat-modal style="display: none;"></chat-modal>
    <game-left-sidebar style="display: none;"></game-left-sidebar>
    <performance-overlay style="display: none;"></performance-overlay>

    <!-- Scripts -->
    <script>
      // Remove preload class after everything is loaded
      window.addEventListener("load", function () {
        requestAnimationFrame(() => {
          document.documentElement.classList.remove("preload");
        });
      });
    </script>
  </body>
</html>